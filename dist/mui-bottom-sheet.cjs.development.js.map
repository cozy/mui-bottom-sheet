{"version":3,"file":"mui-bottom-sheet.cjs.development.js","sources":["../src/util.ts","../src/BottomSheet.tsx"],"sourcesContent":["/**\n * Find the closest value in an array to a given value\n * @param goal target value\n * @param numbers array of numbers to search through\n */\nexport const closest = (goal: number, numbers: number[]) =>\n  numbers.reduce((prev, pos) =>\n    Math.abs(pos - goal) < Math.abs(prev - goal) ? pos : prev\n  );\n\n/**\n * Find the next value in an array to a given value\n * @param goal target value\n * @param direction indicates whether to find for a higher or lower value\n * @param numbers array of numbers to search through\n */\nexport const next = (goal: number, direction: number, numbers: number[]) => {\n  if (direction > 0) {\n    const ascSortedNumbers = [...numbers].sort((a, b) => a - b);\n    return (\n      ascSortedNumbers.find(e => e >= goal) ||\n      ascSortedNumbers[ascSortedNumbers.length - 1]\n    );\n  } else {\n    const descSortedNumbers = [...numbers].sort((a, b) => b - a);\n    return (\n      descSortedNumbers.find(e => e <= goal) ||\n      descSortedNumbers[descSortedNumbers.length - 1]\n    );\n  }\n};\n\n/**\n * Check if a node is inside an other one\n * @param source - Reference node\n * @param target - Node in which we will search if the reference node is present\n * @returns boolean\n */\nexport const isInsideTag = (source: any, target: any) => {\n  let el = source;\n\n  while (el && el.parentNode) {\n    if (el === target) {\n      return true;\n    }\n    el = el.parentNode;\n  }\n\n  return false;\n};\n","import React, { FC, ReactElement, useEffect, useRef } from 'react';\nimport { a, useSpring, config, Globals } from 'react-spring';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { ResizeObserver } from '@juggle/resize-observer';\nimport { closest, next, isInsideTag } from './util';\n\nexport interface bottomSheetOptions {\n  /**\n   * Show backdrop that darkens as the sheet is pulled up. Defaults to true.\n   *\n   * @default true\n   */\n  backdrop?: boolean;\n\n  /**\n   * Background component behind sheet. Requires at least two `peekHeights`.\n   * @default null\n   */\n  background?: ReactElement;\n\n  /**\n   * Current peek index if you want to control the component.\n   * @default 0;\n   */\n  currentIndex?: number;\n\n  /**\n   * Sheet height when in closed state.\n   * @default 100\n   */\n  defaultHeight: number;\n\n  /**\n   * Whether to go allow sheet to go full screen. If false, sheet will max out at largest peekHeight.\n   * @default true\n   */\n  fullHeight: boolean;\n\n  /**\n   * Completely hides the sheet when true.\n   * @default false\n   */\n  hidden: boolean | number;\n\n  /**\n   * Called when the user interacts and moves the bottomsheet to a new peek height\n   */\n  onIndexChange?: (index: number) => void;\n\n  /**\n   * Sheet will stop at certain heights to reveal more info.\n   * @default []\n   */\n  peekHeights?: number[];\n\n  /**\n   * Which spring config to use for snapping the sheet\n   * @default config.stiff\n   */\n  springConfig: Record<string, any>;\n\n  /**\n   * User styles for root, background and backdrop.\n   * @default {root:{},background:{},backdrop:{}}\n   */\n  styles?: bottomSheetStyles;\n\n  /**\n   * Threshold for over-dragging the sheet before snapping to closest height.\n   * @default 70\n   */\n  threshold: number;\n\n  /**\n   * Prevents the sheet from being totally closed\n   * @default false\n   */\n  disabledClosing: boolean;\n\n  /**\n   * Defines how the sheet should be anchored on the snap point\n   * @default false\n   */\n  snapPointSeekerMode: string;\n\n  /**\n   * Remove animations\n   * @default false\n   */\n  skipAnimation: boolean;\n}\n\nexport interface BottomSheetProps extends Partial<bottomSheetOptions> {}\n\nexport interface bottomSheetStyles {\n  backdrop?: Record<string, any>;\n  background?: Record<string, any>;\n  root?: Record<string, any>;\n}\n\n/** Some sensible defaults */\nexport const defaultOptions = {\n  backdrop: true,\n  background: null,\n  defaultHeight: 100,\n  fullHeight: true,\n  hidden: false,\n  peekHeights: [],\n  springConfig: config.stiff,\n  styles: { root: {}, backdrop: {}, background: {} },\n  threshold: 70,\n  disabledClosing: false,\n  snapPointSeekerMode: 'close',\n  skipAnimation: false,\n};\n\nexport const BottomSheet: FC<BottomSheetProps> = props => {\n  /** Merge defaults and provided options */\n  const {\n    backdrop,\n    background,\n    currentIndex,\n    defaultHeight,\n    fullHeight,\n    hidden,\n    onIndexChange,\n    peekHeights,\n    springConfig,\n    styles: userStyles,\n    threshold,\n    disabledClosing,\n    snapPointSeekerMode,\n    skipAnimation,\n  } = {\n    ...defaultOptions,\n    ...props,\n  };\n\n  Globals.assign({ skipAnimation });\n\n  /** Generate stylesheet */\n  const styles: bottomSheetStyles = {\n    backdrop: {\n      position: 'fixed' as React.CSSProperties['position'],\n      bottom: 0,\n      left: 0,\n      right: 0,\n      top: 0,\n      zIndex: 1198,\n      backgroundColor: 'rgba(0,0,0,0.3)',\n    },\n    background: {\n      position: 'fixed' as React.CSSProperties['position'],\n      zIndex: 1199,\n      left: 0,\n      top: 0,\n      width: '100%',\n    },\n    root: {\n      background: '#fff',\n      boxShadow: '0 -10px 20px rgba(0,0,0,0.3)',\n      width: '100%',\n      minHeight: defaultHeight,\n      maxHeight: '100%',\n      position: 'fixed' as React.CSSProperties['position'],\n      left: 0,\n      top: 0,\n      zIndex: 1200,\n    },\n  };\n\n  /** generate stop position relative to window height */\n  const stopPosition = (relativeHeight: number) =>\n    window.innerHeight - relativeHeight;\n\n  /** Create array of possible stop positions */\n  const defaultPosition = stopPosition(defaultHeight);\n  const stops = [defaultPosition];\n\n  /** Track heights */\n  const [measureRef, { height }] = useMeasure({ polyfill: ResizeObserver });\n\n  let max = 0;\n  /** If it's taller than the window, clamp the stops at full screen */\n  if (height > window.innerHeight && fullHeight) {\n    stops.push(0);\n  }\n\n  /** If the el is smaller than the window and larger than the default, add it as a stop. */\n  if (height < window.innerHeight && height > defaultHeight) {\n    max = stopPosition(height);\n    stops.push(max);\n  }\n\n  /** Add peek heights if they are less than the max height.\n   * To don't mess with snap indexes we don't add the peek height if it already in the stops array\n   */\n  peekHeights?.forEach(peekHeight => {\n    if (peekHeight < height && peekHeight < window.innerHeight) {\n      if (!stops.includes(stopPosition(peekHeight))) {\n        stops.push(stopPosition(peekHeight));\n      }\n    }\n  });\n\n  /** By using stopPosition, y-axis is defined from top to bottom,\n  but in peekHeights context, y-axis is defined from bottom to top,\n  so we have to use descending sort here to have a proper matching between stops and snap indexes */\n  stops.sort((a, b) => b - a);\n\n  /** Track container scroll to prevent pulling when not at scrollTop */\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  /** Track animateable styles */\n  const [{ y }, set] = useSpring(() => ({\n    y: defaultPosition,\n  }));\n\n  /** Handle draging */\n  const bind = useDrag(\n    ({ last, cancel, movement: [, my], direction: [dx, dy], event }) => {\n      event?.stopPropagation();\n\n      if (event && event.type && containerRef) {\n        if (!isInsideTag(event.target, containerRef.current)) {\n          return;\n        }\n      }\n\n      /** If the drag is feeling more horizontal than vertical, cancel */\n      if (dx < -0.8 || dx > 0.8) {\n        cancel && cancel();\n      }\n\n      /** Prevent drag if container isn't at top of scroll */\n      if (containerRef?.current?.scrollTop) {\n        return;\n      }\n\n      /**\n       * Cancel the drag if we either hit the top of the screen\n       * or a certain threshold above the max height (Defaults to 70px)\n       */\n      if (my < 0 || my < Math.min(...stops) - threshold) {\n        cancel && cancel();\n      }\n\n      /**\n       * Cancel the drag if we hit the lowest snap point\n       */\n      if (disabledClosing && my > Math.max(...stops)) {\n        cancel && cancel();\n      }\n\n      /** On release, snap to the new stop position */\n      if (last) {\n        let newPosition: number = 0;\n        if (snapPointSeekerMode === 'close') newPosition = closest(my, stops);\n        if (snapPointSeekerMode === 'next') newPosition = next(my, dy, stops);\n\n        set({\n          y: newPosition,\n          config: springConfig,\n        });\n\n        /** Call onIndexChange if it's set */\n        onIndexChange &&\n          onIndexChange(stops.findIndex(stop => stop === newPosition));\n        return;\n      }\n\n      /** On each frame, set the y position */\n      set({\n        y: my,\n        config: { duration: 0 },\n      });\n    },\n    {\n      /**\n       * If the container has been scrolled, we want the sheet\n       * to begin pulling down once the users gets back to the\n       * top of the scroll. initialising the my position as the\n       * negative value of the current scroll sets it to zero\n       * when the user gets to the top of the scrollable area.\n       */\n      initial: () => [\n        0,\n        containerRef.current?.scrollTop\n          ? // @ts-ignore\n            -containerRef.current.scrollTop + Math.min(...stops)\n          : y.goal,\n      ],\n      bounds: { top: 0 },\n    }\n  );\n\n  /** If the hidden prop is true, hide the entire sheet off-screen */\n  useEffect(() => {\n    set({\n      y: hidden ? window.innerHeight + 30 : defaultPosition,\n      config: config.gentle,\n    });\n  }, [hidden, set, defaultPosition]);\n\n  /** Set display:none when the drawer is hidden. */\n  const display = y.to(py => (py < window.innerHeight + 30 ? 'block' : 'none'));\n\n  /**\n   * Lock the scroll of the bottom sheet while it hasn't been\n   * pulled to its maximum possible height.\n   */\n  const overflowY = y.to(v => (v > Math.min(...stops) ? 'hidden' : 'scroll'));\n\n  /** Aggregate main sheet props into an object for spreading */\n  const sheetStyle = {\n    y,\n    display,\n    overflowY,\n  };\n\n  /** Animated styles for the backdrop based off the y position */\n  const backdropActiveAt = [...stops]\n    .reverse()\n    .find(n => n !== defaultPosition && n < defaultPosition);\n\n  const backdropStyle = {\n    /** backdrop should only begin to fade in after first stop */\n    opacity: y.to([(backdropActiveAt as number) || 0, defaultPosition], [1, 0]),\n    /** Set display none when backdrop isn't show so you can interact with the page */\n    display: y.to(py => (py < defaultPosition && backdrop ? 'block' : 'none')),\n  };\n\n  /**\n   * Background is an image or carousel that slides up behind the main\n   * bottom sheet, similar to the venue images on Google maps.\n   */\n  const backgroundStyle = {\n    height: Math.min(...stops.filter(n => n > 0)),\n    y: y.to(\n      [...stops].reverse(),\n      stops.map((_stop, i, arr) =>\n        i === arr.length - 1 || i === arr.length - 2 ? window.innerHeight : 0\n      ),\n      'clamp'\n    ),\n  };\n\n  /**\n   * Handle controlled component changes\n   */\n  useEffect(() => {\n    if (currentIndex !== undefined && y.goal !== stops[currentIndex]) {\n      if (!stops[currentIndex]) {\n        console.warn('No stop exists for the index you set.');\n      }\n      set({\n        y: stops[currentIndex],\n        config: springConfig,\n      });\n    }\n  }, [currentIndex, stops, set, y, springConfig]);\n\n  return (\n    <>\n      <a.div\n        {...bind()}\n        ref={containerRef}\n        // @ts-ignore\n        style={{ ...styles.root, ...userStyles.root, y, ...sheetStyle }}\n      >\n        <div ref={measureRef}>{props.children}</div>\n      </a.div>\n      {background && (\n        <a.div\n          style={{\n            ...styles.background,\n            ...userStyles.background,\n            ...backgroundStyle,\n          }}\n          className=\"background\"\n        >\n          {background}\n        </a.div>\n      )}\n      <a.div\n        // @ts-ignore\n        style={{ ...styles.backdrop, ...userStyles.backdrop, ...backdropStyle }}\n      />\n    </>\n  );\n};\n"],"names":["closest","goal","numbers","reduce","prev","pos","Math","abs","next","direction","ascSortedNumbers","sort","a","b","find","e","length","descSortedNumbers","isInsideTag","source","target","el","parentNode","defaultOptions","backdrop","background","defaultHeight","fullHeight","hidden","peekHeights","springConfig","config","stiff","styles","root","threshold","disabledClosing","snapPointSeekerMode","skipAnimation","BottomSheet","props","currentIndex","onIndexChange","userStyles","Globals","assign","position","bottom","left","right","top","zIndex","backgroundColor","width","boxShadow","minHeight","maxHeight","stopPosition","relativeHeight","window","innerHeight","defaultPosition","stops","useMeasure","polyfill","ResizeObserver","measureRef","height","max","push","forEach","peekHeight","includes","containerRef","useRef","useSpring","y","set","bind","useDrag","last","cancel","movement","my","dx","dy","event","stopPropagation","type","current","scrollTop","min","newPosition","findIndex","stop","duration","initial","bounds","useEffect","gentle","display","to","py","overflowY","v","sheetStyle","backdropActiveAt","reverse","n","backdropStyle","opacity","backgroundStyle","filter","map","_stop","i","arr","undefined","console","warn","React","div","ref","style","children","className"],"mappings":"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"}